"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const url = tslib_1.__importStar(require("url"));
module.exports = {
    name: "command",
    afters: ["auth"],
    befores: ["fix", "directory", "static", "end"],
    _fromFile: true,
    body: async function body(req, res, event) {
        let uri = new url.URL(`http://127.0.0.1:${event.server.opts.port}${req.url}`);
        if (uri.pathname === "/kill") {
            let time = uri.searchParams.get("time"), code = uri.searchParams.get("code");
            res.end("DONE");
            event.stop();
            await event.server.data["parent"].cmds.find((cmd) => cmd.name === "kill").body(time, code);
        }
        else if (uri.pathname === "/eval") {
            let code = uri.searchParams.get("code");
            res.end(await event.server.data["parent"].cmds.find(cmd => cmd.name === "eval").body(code));
            event.stop();
        }
        return event.pass();
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tbWFuZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9taWRkbGV3YXJlcy9jb21tYW5kLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUVBLGlEQUEyQjtBQUczQixNQUFNLENBQUMsT0FBTyxHQUFHO0lBQ2hCLElBQUksRUFBRSxTQUFTO0lBQ2YsTUFBTSxFQUFFLENBQUMsTUFBTSxDQUFDO0lBQ2hCLE9BQU8sRUFBRSxDQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsUUFBUSxFQUFFLEtBQUssQ0FBRTtJQUNoRCxTQUFTLEVBQUUsSUFBSTtJQUNmLElBQUksRUFBRSxLQUFLLFVBQVUsSUFBSSxDQUFDLEdBQXlCLEVBQUUsR0FBd0IsRUFBRSxLQUF3QjtRQUN0RyxJQUFJLEdBQUcsR0FBUSxJQUFJLEdBQUcsQ0FBQyxHQUFHLENBQUMsb0JBQW9CLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUVuRixJQUFJLEdBQUcsQ0FBQyxRQUFRLEtBQUssT0FBTyxFQUFFO1lBQzdCLElBQUksSUFBSSxHQUFXLEdBQUcsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUM5QyxJQUFJLEdBQVcsR0FBRyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7WUFFN0MsR0FBRyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNoQixLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7WUFFYixNQUFNLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFvQixFQUFXLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxLQUFLLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDckg7YUFBTSxJQUFJLEdBQUcsQ0FBQyxRQUFRLEtBQUssT0FBTyxFQUFFO1lBQ3BDLElBQUksSUFBSSxHQUFXLEdBQUcsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRWhELEdBQUcsQ0FBQyxHQUFHLENBQUMsTUFBTSxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksS0FBSyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUM1RixLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7U0FDYjtRQUVELE9BQU8sS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ3JCLENBQUM7Q0FDRCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgaHR0cCBmcm9tIFwiaHR0cFwiO1xuaW1wb3J0ICogYXMgdnNlcnYgZnJvbSBcInZhbGUtc2VydmVyLWlpXCI7XG5pbXBvcnQgKiBhcyB1cmwgZnJvbSBcInVybFwiO1xuaW1wb3J0IHsgQ2xhc3NlcyB9IGZyb20gXCIuLi9wYW5lbFwiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblx0bmFtZTogXCJjb21tYW5kXCIsXG5cdGFmdGVyczogW1wiYXV0aFwiXSxcblx0YmVmb3JlczogWyBcImZpeFwiLCBcImRpcmVjdG9yeVwiLCBcInN0YXRpY1wiLCBcImVuZFwiIF0sXG5cdF9mcm9tRmlsZTogdHJ1ZSxcblx0Ym9keTogYXN5bmMgZnVuY3Rpb24gYm9keShyZXE6IGh0dHAuSW5jb21pbmdNZXNzYWdlLCByZXM6IGh0dHAuU2VydmVyUmVzcG9uc2UsIGV2ZW50OiB2c2Vydi5DbGFzc2VzLmV2dCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdGxldCB1cmk6IFVSTCA9IG5ldyB1cmwuVVJMKGBodHRwOi8vMTI3LjAuMC4xOiR7ZXZlbnQuc2VydmVyLm9wdHMucG9ydH0ke3JlcS51cmx9YCk7XG5cdFx0XG5cdFx0aWYgKHVyaS5wYXRobmFtZSA9PT0gXCIva2lsbFwiKSB7XG5cdFx0XHRsZXQgdGltZTogc3RyaW5nID0gdXJpLnNlYXJjaFBhcmFtcy5nZXQoXCJ0aW1lXCIpLFxuXHRcdFx0XHRjb2RlOiBzdHJpbmcgPSB1cmkuc2VhcmNoUGFyYW1zLmdldChcImNvZGVcIik7XG5cdFx0XHRcblx0XHRcdHJlcy5lbmQoXCJET05FXCIpO1xuXHRcdFx0ZXZlbnQuc3RvcCgpO1xuXG5cdFx0XHRhd2FpdCBldmVudC5zZXJ2ZXIuZGF0YVtcInBhcmVudFwiXS5jbWRzLmZpbmQoKGNtZDogQ2xhc3Nlcy5Db21tYW5kKTogYm9vbGVhbiA9PiBjbWQubmFtZSA9PT0gXCJraWxsXCIpLmJvZHkodGltZSwgY29kZSk7XG5cdFx0fSBlbHNlIGlmICh1cmkucGF0aG5hbWUgPT09IFwiL2V2YWxcIikge1xuXHRcdFx0bGV0IGNvZGU6IHN0cmluZyA9IHVyaS5zZWFyY2hQYXJhbXMuZ2V0KFwiY29kZVwiKTtcblx0XHRcdFxuXHRcdFx0cmVzLmVuZChhd2FpdCBldmVudC5zZXJ2ZXIuZGF0YVtcInBhcmVudFwiXS5jbWRzLmZpbmQoY21kID0+IGNtZC5uYW1lID09PSBcImV2YWxcIikuYm9keShjb2RlKSk7XG5cdFx0XHRldmVudC5zdG9wKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGV2ZW50LnBhc3MoKTtcblx0fVxufTtcbiJdfQ==